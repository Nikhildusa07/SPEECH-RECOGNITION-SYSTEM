<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speech-To-Text System</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4, #45b7d1, #96c93d);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            color: white;
        }
        .container {
            background: rgba(255, 255, 255, 0.9);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            width: 500px;
            text-align: center;
            border: 2px solid #ff9f43;
        }
        h2 {
            color: #2d3436;
            font-size: 28px;
            margin-bottom: 30px;
        }
        button {
            background: linear-gradient(135deg, #0984e3, #00cec9);
            color: white;
            border: none;
            padding: 14px 20px;
            font-size: 16px;
            border-radius: 50px;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
            width: 100%;
            margin: 15px 0;
        }
        button:hover {
            background: linear-gradient(135deg, #00cec9, #0984e3);
            transform: translateY(-2px);
        }
        input[type="file"] {
            display: none;
        }
        .upload-btn, .record-btn {
            padding: 14px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s ease;
            color: white;
            margin: 15px 0;
        }
        .upload-btn:hover, .record-btn:hover {
            transform: translateY(-2px);
        }
        .upload-btn {
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
        }
        .upload-btn:hover {
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
        }
        .record-btn:nth-child(1) {
            background: linear-gradient(135deg, #e84393, #ff7675);
        }
        .record-btn:nth-child(1):hover {
            background: linear-gradient(135deg, #ff7675, #e84393);
        }
        .record-btn:nth-child(2) {
            background: linear-gradient(135deg, #fdcb6e, #f1c40f);
        }
        .record-btn:nth-child(2):hover {
            background: linear-gradient(135deg, #f1c40f, #fdcb6e);
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Speech-To-Text System</h2>

        <form action="/transcribe" method="post" enctype="multipart/form-data">
            <label class="upload-btn" for="file">Upload Audio</label>
            <input type="file" id="file" name="file" accept="audio/*">
            <button type="submit">Transcribe Uploaded</button>
        </form>

        <form id="recordForm" method="post" action="/transcribe" enctype="multipart/form-data">
            <button type="button" class="record-btn" onclick="startRecording()">Start Recording</button>
            <button type="button" class="record-btn" onclick="stopRecording()">Stop & Transcribe</button>
            <input type="file" id="audio_data" name="audio_data" hidden>
        </form>
    </div>

    <script>
        let mediaRecorder, audioChunks = [];

        function startRecording() {
            navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
                mediaRecorder = new MediaRecorder(stream);
                mediaRecorder.start();
                audioChunks = [];
                mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
            }).catch(err => alert("Microphone access denied: " + err));
        }

        function stopRecording() {
            if (mediaRecorder && mediaRecorder.state !== "inactive") {
                mediaRecorder.stop();
                mediaRecorder.onstop = () => {
                    const blob = new Blob(audioChunks, { type: 'audio/webm' });
                    const file = new File([blob], "recording.webm");
                    const dataTransfer = new DataTransfer();
                    dataTransfer.items.add(file);
                    const fileInput = document.getElementById("audio_data");
                    fileInput.files = dataTransfer.files;
                    document.getElementById("recordForm").submit();
                };
            }
        }
    </script>
</body>
</html>